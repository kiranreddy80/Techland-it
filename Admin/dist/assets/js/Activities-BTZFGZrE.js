import{j as e}from"./icons-vendor-6kYSYytV.js";import{r as l}from"./react-vendor-D27a9yTA.js";import{c as k,a as c}from"./index-DtrFaUYL.js";import{y as a}from"./utils-CVcC53YC.js";import"./animation-vendor-wr8mJRns.js";function _(){const[d,p]=l.useState([]),[A,o]=l.useState(!1),[i,n]=l.useState({title:"",description:"",date:"",photo:null}),[u,h]=l.useState(""),m=k.ASSETS_URL,[x,g]=l.useState(!1),[r,j]=l.useState(null),f=async()=>{try{const{data:t}=await c.get("/activities");p(t)}catch(t){console.error("Error fetching activities:",t),a.error("Failed to load activities")}};l.useEffect(()=>{f()},[]);const v=(t=null)=>{t?(n({title:t.title,description:t.description,date:t.date,photo:null}),h(t.image.startsWith("http")?t.image:`${m}${t.image}`),j(t._id)):(n({title:"",description:"",date:"",photo:null}),h(""),j(null)),o(!0)},w=async t=>{var y,b;t.preventDefault(),g(!0);const s=new FormData;s.append("title",i.title),s.append("description",i.description),s.append("date",i.date),i.photo&&s.append("image",i.photo);try{r?(await c.put(`/activities/${r}`,s,{headers:{"Content-Type":"multipart/form-data"}}),a.success("Activity updated successfully")):(await c.post("/activities",s,{headers:{"Content-Type":"multipart/form-data"}}),a.success("Activity added successfully")),f(),o(!1)}catch(N){console.error("Error saving activity:",N);const E=((b=(y=N.response)==null?void 0:y.data)==null?void 0:b.message)||`Failed to ${r?"update":"add"} activity`;a.error(E)}finally{g(!1)}},C=async t=>{try{await c.patch(`/activities/${t}/toggle`),p(d.map(s=>s._id===t?{...s,isActive:!s.isActive}:s)),a.success("Status updated")}catch(s){console.error("Error toggling status:",s),a.error("Failed to update status")}},S=async t=>{if(confirm("Are you sure you want to remove this activity?"))try{await c.delete(`/activities/${t}`),p(d.filter(s=>s._id!==t)),a.success("Activity removed")}catch(s){console.error("Error deleting activity:",s),a.error("Failed to delete activity")}};return e.jsxs("div",{className:"dashboard-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("h1",{className:"admin-title",children:"Our Activities"}),e.jsx("p",{className:"admin-subtitle",children:"Update and manage team events and activities."})]}),e.jsx("button",{className:"quick-action-btn primary",style:{width:"auto"},onClick:()=>v(),children:"+ Add New Activity"})]}),e.jsx("div",{className:"panel",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"custom-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsxs("tbody",{children:[d.map(t=>e.jsxs("tr",{style:{opacity:t.isActive?1:.6},children:[e.jsx("td",{children:e.jsx("img",{src:t.image.startsWith("http")?t.image:`${m}${t.image}`,alt:"",className:"avatar-preview",style:{borderRadius:"4px",width:"60px",height:"40px"}})}),e.jsx("td",{children:e.jsx("strong",{children:t.title})}),e.jsx("td",{children:t.date}),e.jsx("td",{children:e.jsxs("label",{className:"switch",children:[e.jsx("input",{type:"checkbox",checked:t.isActive,onChange:()=>C(t._id)}),e.jsx("span",{className:"slider"})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{className:"delete-btn-icon",onClick:()=>v(t),title:"Edit",children:"âœï¸"}),e.jsx("button",{className:"delete-btn-icon",onClick:()=>S(t._id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},t._id)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:{textAlign:"center",padding:"20px"},children:"No activities found."})})]})]})})}),A&&e.jsx("div",{className:"modal-overlay",onClick:t=>{t.target===t.currentTarget&&o(!1)},children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:r?"Edit Activity":"Add New Activity"}),e.jsx("button",{className:"close-btn",onClick:()=>o(!1),children:"Ã—"})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Title"}),e.jsx("input",{type:"text",className:"form-input",value:i.title,onChange:t=>n({...i,title:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Date (e.g., June 5, 2025)"}),e.jsx("input",{type:"text",className:"form-input",value:i.date,onChange:t=>n({...i,date:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{className:"form-input",value:i.description,onChange:t=>n({...i,description:t.target.value}),rows:"3",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Activity Photo"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"5px"},children:[e.jsx("label",{htmlFor:"photo-upload",className:"table-action-btn",style:{cursor:"pointer",background:"#f3f4f6"},children:"ðŸ“‚ Choose File"}),e.jsx("span",{style:{fontSize:"12px",color:"#6b7280"},children:i.photo?i.photo.name:"No file chosen"})]}),e.jsx("input",{id:"photo-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:t=>{const s=t.target.files[0];s&&(n({...i,photo:s}),h(URL.createObjectURL(s)))},required:!r})]}),u&&e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx("img",{src:u,alt:"Preview",style:{width:"200px",height:"120px",objectFit:"cover",borderRadius:"8px"}})}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:x,children:x?r?"Updating...":"Adding...":r?"Update Activity":"Add Activity"})]})]})})]})}export{_ as default};
