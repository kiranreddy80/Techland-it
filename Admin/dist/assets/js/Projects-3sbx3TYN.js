import{j as e}from"./icons-vendor-6kYSYytV.js";import{r as o}from"./react-vendor-D27a9yTA.js";import{c as E,a as c}from"./index-CktEfMlw.js";import{y as r}from"./utils-CVcC53YC.js";import"./animation-vendor-wr8mJRns.js";function D(){const[d,u]=o.useState([]),[N,h]=o.useState(!1),[a,i]=o.useState({title:"",category:"",client:"",status:"Completed",photo:null}),[x,p]=o.useState(""),m=E.ASSETS_URL,[g,j]=o.useState(!1),[n,f]=o.useState(null),y=async()=>{try{const{data:t}=await c.get("/projects");u(t)}catch(t){console.error("Error fetching projects:",t),r.error("Failed to load projects")}};o.useEffect(()=>{y()},[]);const b=(t=null)=>{t?(i({title:t.title,category:t.category,client:t.client,status:t.status,photo:null}),p(t.image.startsWith("http")?t.image:`${m}${t.image}`),f(t._id)):(i({title:"",category:"",client:"",status:"Completed",photo:null}),p(""),f(null)),h(!0)},P=async t=>{var l,v;t.preventDefault(),j(!0);const s=new FormData;s.append("title",a.title),s.append("category",a.category),s.append("client",a.client),s.append("status",a.status),a.photo&&s.append("image",a.photo);try{n?(await c.put(`/projects/${n}`,s,{headers:{"Content-Type":"multipart/form-data"}}),r.success("Project updated successfully")):(await c.post("/projects",s,{headers:{"Content-Type":"multipart/form-data"}}),r.success("Project added successfully")),y(),h(!1)}catch(C){console.error("Error saving project:",C);const k=((v=(l=C.response)==null?void 0:l.data)==null?void 0:v.message)||`Failed to ${n?"update":"add"} project`;r.error(k)}finally{j(!1)}},w=async t=>{try{await c.patch(`/projects/${t}/toggle`),u(d.map(s=>s._id===t?{...s,isActive:!s.isActive}:s)),r.success("Status updated")}catch(s){console.error("Error toggling status:",s),r.error("Failed to update status")}},S=async(t,s)=>{try{await c.patch(`/projects/${t}/status`,{status:s}),u(d.map(l=>l._id===t?{...l,status:s}:l)),r.success("Project status updated")}catch(l){console.error("Error updating status text:",l),r.error("Failed to update status text")}},A=async t=>{if(confirm("Are you sure you want to delete this project?"))try{await c.delete(`/projects/${t}`),u(d.filter(s=>s._id!==t)),r.success("Project removed")}catch(s){console.error("Error deleting project:",s),r.error("Failed to delete project")}};return e.jsxs("div",{className:"dashboard-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("h1",{className:"admin-title",children:"Projects Portfolio"}),e.jsx("p",{className:"admin-subtitle",children:"Showcase your best work and manage project statuses."})]}),e.jsx("button",{className:"quick-action-btn primary",style:{width:"auto"},onClick:()=>b(),children:"+ Add New Project"})]}),e.jsx("div",{className:"panel",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"custom-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Project Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Visible"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsxs("tbody",{children:[d.map(t=>e.jsxs("tr",{style:{opacity:t.isActive?1:.6},children:[e.jsx("td",{children:e.jsx("img",{src:t.image.startsWith("http")?t.image:`${m}${t.image}`,alt:"",className:"avatar-preview",style:{borderRadius:"8px",width:"70px",height:"45px",objectFit:"cover"}})}),e.jsx("td",{children:e.jsx("strong",{children:t.title})}),e.jsx("td",{children:t.category}),e.jsx("td",{children:t.client}),e.jsx("td",{children:e.jsxs("select",{value:t.status,onChange:s=>S(t._id,s.target.value),style:{padding:"5px 10px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",border:"1px solid #e5e7eb",background:t.status==="Completed"?"#dcfce7":t.status==="In Progress"?"#dbeafe":"#fef3c7",color:t.status==="Completed"?"#15803d":t.status==="In Progress"?"#1e40af":"#b45309"},children:[e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Pending",children:"Pending"})]})}),e.jsx("td",{children:e.jsxs("label",{className:"switch",children:[e.jsx("input",{type:"checkbox",checked:t.isActive,onChange:()=>w(t._id)}),e.jsx("span",{className:"slider"})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{className:"delete-btn-icon",onClick:()=>b(t),title:"Edit",children:"âœï¸"}),e.jsx("button",{className:"delete-btn-icon",onClick:()=>A(t._id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},t._id)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{textAlign:"center",padding:"20px"},children:"No projects found."})})]})]})})}),N&&e.jsx("div",{className:"modal-overlay",onClick:t=>{t.target===t.currentTarget&&h(!1)},children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:n?"Edit Project":"Add New Project"}),e.jsx("button",{className:"close-btn",onClick:()=>h(!1),children:"Ã—"})]}),e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Project Title"}),e.jsx("input",{type:"text",className:"form-input",value:a.title,onChange:t=>i({...a,title:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"e.g. Web Development, App Design",value:a.category,onChange:t=>i({...a,category:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Client"}),e.jsx("input",{type:"text",className:"form-input",value:a.client,onChange:t=>i({...a,client:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Project Status"}),e.jsxs("select",{className:"form-input",value:a.status,onChange:t=>i({...a,status:t.target.value}),children:[e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Pending",children:"Pending"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Thumbnail Photo"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"5px"},children:[e.jsx("label",{htmlFor:"photo-upload",className:"table-action-btn",style:{cursor:"pointer",background:"#f3f4f6"},children:"ðŸ“‚ Choose File"}),e.jsx("span",{style:{fontSize:"12px",color:"#6b7280"},children:a.photo?a.photo.name:"No file chosen"})]}),e.jsx("input",{id:"photo-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:t=>{const s=t.target.files[0];s&&(i({...a,photo:s}),p(URL.createObjectURL(s)))},required:!n})]}),x&&e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx("img",{src:x,alt:"Preview",style:{width:"200px",height:"120px",objectFit:"cover",borderRadius:"8px"}})}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:g,children:g?n?"Updating...":"Creating...":n?"Update Project":"Create Project"})]})]})})]})}export{D as default};
