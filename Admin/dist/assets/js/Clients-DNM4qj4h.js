import{j as e}from"./icons-vendor-6kYSYytV.js";import{r as i}from"./react-vendor-D27a9yTA.js";import{c as k,a as o}from"./index-DtrFaUYL.js";import{y as a}from"./utils-CVcC53YC.js";import"./animation-vendor-wr8mJRns.js";function D(){const[d,h]=i.useState([]),[N,c]=i.useState(!1),[n,r]=i.useState({name:"",industry:"",logo:null}),[u,p]=i.useState(""),m=k.ASSETS_URL,[x,g]=i.useState(!1),[l,y]=i.useState(null),j=async()=>{try{const{data:t}=await o.get("/clients");h(t)}catch(t){console.error("Error fetching clients:",t),a.error("Failed to load clients")}};i.useEffect(()=>{j()},[]);const f=(t=null)=>{t?(r({name:t.name,industry:t.industry,logo:null}),p(t.logo.startsWith("http")?t.logo:`${m}${t.logo}`),y(t._id)):(r({name:"",industry:"",logo:null}),p(""),y(null)),c(!0)},w=async t=>{var b,v;t.preventDefault(),g(!0);const s=new FormData;s.append("name",n.name),s.append("industry",n.industry),n.logo&&s.append("image",n.logo);try{l?(await o.put(`/clients/${l}`,s,{headers:{"Content-Type":"multipart/form-data"}}),a.success("Client updated successfully")):(await o.post("/clients",s,{headers:{"Content-Type":"multipart/form-data"}}),a.success("Client added successfully")),j(),c(!1)}catch(C){console.error("Error saving client:",C),a.error(((v=(b=C.response)==null?void 0:b.data)==null?void 0:v.message)||`Failed to ${l?"update":"add"} client`)}finally{g(!1)}},S=async t=>{try{await o.patch(`/clients/${t}/toggle`),h(d.map(s=>s._id===t?{...s,isActive:!s.isActive}:s)),a.success("Status updated")}catch(s){console.error("Error toggling status:",s),a.error("Failed to update status")}},A=async t=>{if(confirm("Are you sure you want to remove this client?"))try{await o.delete(`/clients/${t}`),h(d.filter(s=>s._id!==t)),a.success("Client removed")}catch(s){console.error("Error deleting client:",s),a.error("Failed to delete client")}};return e.jsxs("div",{className:"dashboard-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("h1",{className:"admin-title",children:"Clients & Partners"}),e.jsx("p",{className:"admin-subtitle",children:"Manage the companies and brands you work with."})]}),e.jsx("button",{className:"quick-action-btn primary",style:{width:"auto"},onClick:()=>f(),children:"+ Add New Client"})]}),e.jsx("div",{className:"panel",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"custom-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Logo"}),e.jsx("th",{children:"Company Name"}),e.jsx("th",{children:"Industry"}),e.jsx("th",{children:"Visible"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsxs("tbody",{children:[d.map(t=>e.jsxs("tr",{style:{opacity:t.isActive?1:.6},children:[e.jsx("td",{children:e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"8px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #e5e7eb",padding:"5px",overflow:"hidden"},children:e.jsx("img",{src:t.logo.startsWith("http")?t.logo:`${m}${t.logo}`,alt:"",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})}),e.jsx("td",{children:e.jsx("strong",{children:t.name})}),e.jsx("td",{children:t.industry}),e.jsx("td",{children:e.jsxs("label",{className:"switch",children:[e.jsx("input",{type:"checkbox",checked:t.isActive,onChange:()=>S(t._id)}),e.jsx("span",{className:"slider"})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{className:"delete-btn-icon",onClick:()=>f(t),title:"Edit",children:"âœï¸"}),e.jsx("button",{className:"delete-btn-icon",onClick:()=>A(t._id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},t._id)),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",style:{textAlign:"center",padding:"20px"},children:"No clients found."})})]})]})})}),N&&e.jsx("div",{className:"modal-overlay",onClick:t=>{t.target===t.currentTarget&&c(!1)},children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:l?"Edit Client":"Add New Client"}),e.jsx("button",{className:"close-btn",onClick:()=>c(!1),children:"Ã—"})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Company Name"}),e.jsx("input",{type:"text",className:"form-input",value:n.name,onChange:t=>r({...n,name:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Industry"}),e.jsx("input",{type:"text",className:"form-input",value:n.industry,onChange:t=>r({...n,industry:t.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Company Logo"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"5px"},children:[e.jsx("label",{htmlFor:"logo-upload",className:"table-action-btn",style:{cursor:"pointer",background:"#f3f4f6"},children:"ðŸ“‚ Choose File"}),e.jsx("span",{style:{fontSize:"12px",color:"#6b7280"},children:n.logo?n.logo.name:"No file chosen"})]}),e.jsx("input",{id:"logo-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:t=>{const s=t.target.files[0];s&&(r({...n,logo:s}),p(URL.createObjectURL(s)))},required:!l})]}),u&&e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx("img",{src:u,alt:"Preview",style:{width:"100px",height:"100px",objectFit:"contain",border:"1px solid #eee",borderRadius:"8px",padding:"10px"}})}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:x,children:x?l?"Updating...":"Adding...":l?"Update Client":"Add Client"})]})]})})]})}export{D as default};
