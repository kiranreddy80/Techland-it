import{j as e}from"./icons-vendor-6kYSYytV.js";import{r as l}from"./react-vendor-D27a9yTA.js";import{c as A,a as d}from"./index-B0mp45q4.js";import{y as i}from"./utils-CVcC53YC.js";import"./animation-vendor-wr8mJRns.js";function R(){const[o,m]=l.useState([]),[w,c]=l.useState(!1),[a,r]=l.useState({name:"",designation:"",message:"",rating:5,image:null}),[h,g]=l.useState(""),p=A.ASSETS_URL,[u,x]=l.useState(!1),[n,j]=l.useState(null),f=async()=>{try{const{data:s}=await d.get("/testimonials");m(s)}catch(s){console.error("Error fetching testimonials:",s),i.error("Failed to load testimonials")}};l.useEffect(()=>{f()},[]);const y=(s=null)=>{s?(r({name:s.name,designation:s.designation,message:s.message,rating:s.rating,image:null}),g(s.image.startsWith("http")?s.image:`${p}${s.image}`),j(s._id)):(r({name:"",designation:"",message:"",rating:5,image:null}),g(""),j(null)),c(!0)},C=async s=>{var b,v;if(s.preventDefault(),!n&&!a.image){i.error("Please upload an image");return}x(!0);const t=new FormData;t.append("name",a.name),t.append("designation",a.designation),t.append("message",a.message),t.append("rating",a.rating),a.image&&t.append("image",a.image);try{n?(await d.put(`/testimonials/${n}`,t,{headers:{"Content-Type":"multipart/form-data"}}),i.success("Testimonial updated successfully")):(await d.post("/testimonials",t,{headers:{"Content-Type":"multipart/form-data"}}),i.success("Testimonial added successfully")),f(),c(!1)}catch(N){console.error("Error saving testimonial:",N),i.error(((v=(b=N.response)==null?void 0:b.data)==null?void 0:v.message)||`Failed to ${n?"update":"add"} testimonial`)}finally{x(!1)}},T=async s=>{try{await d.patch(`/testimonials/${s}/toggle`),m(o.map(t=>t._id===s?{...t,isActive:!t.isActive}:t)),i.success("Status updated")}catch(t){console.error("Error toggling status:",t),i.error("Failed to update status")}},S=async s=>{if(confirm("Are you sure you want to remove this testimonial?"))try{await d.delete(`/testimonials/${s}`),m(o.filter(t=>t._id!==s)),i.success("Testimonial removed")}catch(t){console.error("Error deleting testimonial:",t),i.error("Failed to delete testimonial")}};return e.jsxs("div",{className:"dashboard-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("h1",{className:"admin-title",children:"Testimonials"}),e.jsx("p",{className:"admin-subtitle",children:"Manage client feedback and reviews."})]}),e.jsx("button",{className:"quick-action-btn primary",style:{width:"auto"},onClick:()=>y(),children:"+ Add New Testimonial"})]}),e.jsx("div",{className:"panel",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"custom-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Designation"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"Rating"}),e.jsx("th",{children:"Visible"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsxs("tbody",{children:[o.map(s=>e.jsxs("tr",{style:{opacity:s.isActive?1:.6},children:[e.jsx("td",{children:e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #e5e7eb",overflow:"hidden"},children:e.jsx("img",{src:s.image.startsWith("http")?s.image:`${p}${s.image}`,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}})})}),e.jsx("td",{children:e.jsx("strong",{children:s.name})}),e.jsx("td",{children:s.designation}),e.jsx("td",{style:{maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.message}),e.jsxs("td",{children:[s.rating," â­"]}),e.jsx("td",{children:e.jsxs("label",{className:"switch",children:[e.jsx("input",{type:"checkbox",checked:s.isActive,onChange:()=>T(s._id)}),e.jsx("span",{className:"slider"})]})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[e.jsx("button",{className:"delete-btn-icon",onClick:()=>y(s),title:"Edit",children:"âœï¸"}),e.jsx("button",{className:"delete-btn-icon",onClick:()=>S(s._id),title:"Delete",children:"ðŸ—‘ï¸"})]})})]},s._id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",style:{textAlign:"center",padding:"20px"},children:"No testimonials found."})})]})]})})}),w&&e.jsx("div",{className:"modal-overlay",onClick:s=>{s.target===s.currentTarget&&c(!1)},children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:n?"Edit Testimonial":"Add New Testimonial"}),e.jsx("button",{className:"close-btn",onClick:()=>c(!1),children:"Ã—"})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{type:"text",className:"form-input",value:a.name,onChange:s=>r({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Designation"}),e.jsx("input",{type:"text",className:"form-input",value:a.designation,onChange:s=>r({...a,designation:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rating"}),e.jsx("input",{type:"number",min:"1",max:"5",step:"0.1",className:"form-input",value:a.rating,onChange:s=>r({...a,rating:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Message"}),e.jsx("textarea",{className:"form-input",value:a.message,onChange:s=>r({...a,message:s.target.value}),required:!0,rows:"4"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Author Image"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"5px"},children:[e.jsx("label",{htmlFor:"image-upload",className:"table-action-btn",style:{cursor:"pointer",background:"#f3f4f6"},children:"ðŸ“‚ Choose File"}),e.jsx("span",{style:{fontSize:"12px",color:"#6b7280"},children:a.image?a.image.name:"No file chosen"})]}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:s=>{const t=s.target.files[0];t&&(r({...a,image:t}),g(URL.createObjectURL(t)))},required:!n})]}),h&&e.jsx("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"},children:e.jsx("img",{src:h,alt:"Preview",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"50%",border:"1px solid #eee",padding:"5px"}})}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:u,children:u?n?"Updating...":"Adding...":n?"Update Testimonial":"Add Testimonial"})]})]})})]})}export{R as default};
